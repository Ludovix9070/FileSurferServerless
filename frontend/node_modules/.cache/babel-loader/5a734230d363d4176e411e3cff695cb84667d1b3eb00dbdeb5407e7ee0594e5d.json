{"ast":null,"code":"import _slicedToArray from\"/home/valerio/Uni/SDCC/FileSurferServerless/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{BrowserRouter,NavLink,Route,Switch}from\"react-router-dom\";import Home from\"./Home\";import Register from\"./Register\";import Login from\"./Login\";import FileUpload from\"./FileUpload\";import PublicRoute from\"./routes/PublicRoute\";import PrivateRoute from\"./routes/PrivateRoutes\";import React,{useEffect,useState}from\"react\";import{getUser,getToken,setUserSession,resetUserSession}from\"./service/AuthService\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var verifyTokenAPIUrl='https://yv8a67sww8.execute-api.us-east-1.amazonaws.com/prod/verify';function App(){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isAuthenticating=_useState2[0],setAuthenticating=_useState2[1];useEffect(function(){var token=getToken();if(token==='undefined'||token===undefined||token===null||!token){return;}var requestConfig={headers:{'x-api-key':'CqIRvghfaQlNhPna9d7P9q39aRmEwMT87auwBmF0'}};var requestBody={user:getUser(),token:token};axios.post(verifyTokenAPIUrl,requestBody,requestConfig).then(function(response){setUserSession(response.data.user,response.data.token);setAuthenticating(false);//se il token è stato validato\n}).catch(function(){resetUserSession();setAuthenticating(false);//se l'autenticazione è completata\n});},[]);var token=getToken();if(isAuthenticating&&token){return/*#__PURE__*/_jsx(\"div\",{className:\"content\",children:\" Authenticating ...\"});}return/*#__PURE__*/_jsx(\"div\",{className:\"App\",children:/*#__PURE__*/_jsxs(BrowserRouter,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"header\",children:[/*#__PURE__*/_jsx(NavLink,{exact:true,activeClassName:\"active\",to:\"/\",children:\"Home\"}),/*#__PURE__*/_jsx(NavLink,{activeClassName:\"active\",to:\"/register\",children:\"Register\"}),/*#__PURE__*/_jsx(NavLink,{activeClassName:\"active\",to:\"/login\",children:\"Login\"}),/*#__PURE__*/_jsx(NavLink,{activeClassName:\"active\",to:\"/file-upload\",children:\"Upload\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"content\",children:/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{exact:true,path:\"/\",component:Home}),/*#__PURE__*/_jsx(PublicRoute,{path:\"/register\",component:Register}),/*#__PURE__*/_jsx(PublicRoute,{path:\"/login\",component:Login}),/*#__PURE__*/_jsx(PrivateRoute,{path:\"/file-upload\",component:FileUpload})]})})]})});}export default App;","map":{"version":3,"names":["BrowserRouter","NavLink","Route","Switch","Home","Register","Login","FileUpload","PublicRoute","PrivateRoute","React","useEffect","useState","getUser","getToken","setUserSession","resetUserSession","axios","jsx","_jsx","jsxs","_jsxs","verifyTokenAPIUrl","App","_useState","_useState2","_slicedToArray","isAuthenticating","setAuthenticating","token","undefined","requestConfig","headers","requestBody","user","post","then","response","data","catch","className","children","exact","activeClassName","to","path","component"],"sources":["/home/valerio/Uni/SDCC/FileSurferServerless/frontend/src/App.js"],"sourcesContent":["import { BrowserRouter, NavLink, Route, Switch } from \"react-router-dom\";\nimport Home from \"./Home\";\nimport Register from \"./Register\";\nimport Login from \"./Login\";\nimport FileUpload from \"./FileUpload\";\nimport PublicRoute from \"./routes/PublicRoute\";\nimport PrivateRoute from \"./routes/PrivateRoutes\";\nimport React, { useEffect, useState } from \"react\";\nimport { getUser, getToken, setUserSession, resetUserSession } from \"./service/AuthService\";\nimport axios from \"axios\";\n\nconst verifyTokenAPIUrl = 'https://yv8a67sww8.execute-api.us-east-1.amazonaws.com/prod/verify';\n\nfunction App() {\n\n  const [isAuthenticating, setAuthenticating] = useState(true);\n\n  useEffect(() => {\n    const token = getToken();\n    if(token === 'undefined' || token === undefined || token === null || !token){\n      return;\n    }\n\n    const requestConfig = {\n      headers: {\n          'x-api-key': 'CqIRvghfaQlNhPna9d7P9q39aRmEwMT87auwBmF0'\n      }\n    }\n\n    const requestBody = {\n      user: getUser(),\n      token: token\n    }\n\n    axios.post(verifyTokenAPIUrl, requestBody, requestConfig).then(response => {\n      setUserSession(response.data.user, response.data.token);\n      setAuthenticating(false); //se il token è stato validato\n    }).catch(() => {\n      resetUserSession();\n      setAuthenticating(false); //se l'autenticazione è completata\n    })\n\n  }, []);\n\n  const token = getToken();\n  if(isAuthenticating && token){\n    return <div className=\"content\"> Authenticating ...</div>\n  }\n\n  return (\n    <div className=\"App\">\n      <BrowserRouter>\n      <div className=\"header\">\n        <NavLink exact activeClassName=\"active\" to=\"/\">Home</NavLink>\n        <NavLink activeClassName=\"active\" to=\"/register\">Register</NavLink>\n        <NavLink activeClassName=\"active\" to=\"/login\">Login</NavLink>\n        <NavLink activeClassName=\"active\" to=\"/file-upload\">Upload</NavLink>\n      </div>\n      <div className=\"content\">\n        <Switch>\n          <Route exact path=\"/\" component={Home}/>\n          <PublicRoute path=\"/register\" component={Register}/>\n          <PublicRoute path=\"/login\" component={Login}/>\n          <PrivateRoute path=\"/file-upload\" component={FileUpload}/>\n        </Switch>\n      </div>\n      </BrowserRouter>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}